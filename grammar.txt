functionDefinition : DEF IDENTIFIER OPAREN optParamList CPAREN OBRACE optExpressionList CBRACE

optParamList : EPSILON
             | paramList

paramList : IDENTIFIER
          | IDENTIFIER COMMA paramList

optExpressionList : EPSILON
                 | expressionList

expressionList : expression
              | expression expressionList

expression : variableDeclaration
           | ifStatement
           | whileStatement
           | OPAREN expression CPAREN
           | anonymousFunction
           | functionDefinition
           | identExpr
           | primExpr

identExpr : varAssign
          | functionCall
          | hoFuncCall

primExpr : primary
         | primary OPERATOR expr

variableDeclaration : LET IDENTIFIER
                    | LET IDENTIFIER EQUAL expression

variableAssignment : IDENTIFIER EQUAL expression

ifStatement : IF OPAREN expression CPAREN OBRACE expressionList CBRACE optElse

optElse : EPSILON
        | ELSE ifStatement
        | ELSE OBRACE expressionList CBRACE

whileStatement : WHILE OPAREN expression CPAREN OBRACE expressionList CBRACE

primary : NUMBER
        | STRING
        | IDENTIFIER 

operator : PLUS
         | MINUS
         | TIMES
         | DIVIDE
         | DOUBLE_EQUAL
         | GREATER_THAN
         | LESS_THAN

functionCall : IDENTIFIER OPAREN optArgList CPAREN optAnonArg

optAnonArg : EPSILON
           | OBRACE expressionList CBRACE

optArgList : EPSILON
           | argList

argList : IDENTIFIER
        | IDENTIFIER argList

anonymousFunction : LAMBDA OPAREN optParamList CPAREN OBRACE optExpressionList CBRACE
